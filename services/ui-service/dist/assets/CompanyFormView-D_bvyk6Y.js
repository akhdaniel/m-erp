import{d as D,p as b,k as S,y as q,r as A,o as E,l as B,m as f,j as M,i as n,a as e,t as i,g,h as w,n as P,w as N,c as r,b as d,f as x,e as m,v,x as p,q as j,z}from"./index-Cr4MYUY-.js";import{_ as L}from"./AppLayout.vue_vue_type_script_setup_true_lang-DU1WgjSg.js";import{u as R}from"./companies-Bc3UktZV.js";import{r as F}from"./ExclamationTriangleIcon-Dajd-O-b.js";const J={class:"space-y-6"},O={class:"md:flex md:items-center md:justify-between"},Y={class:"flex-1 min-w-0"},$={class:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate"},G={class:"mt-1 text-sm text-gray-500"},I={class:"mt-4 flex md:mt-0 md:ml-4"},T={class:"card"},W={key:0,class:"rounded-md bg-red-50 p-4"},H={class:"flex"},Z={class:"flex-shrink-0"},K={class:"ml-3"},Q={class:"mt-2 text-sm text-red-700"},X={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},ee={class:"mt-1"},te={key:0,class:"mt-2 text-sm text-red-600"},se={class:"mt-1"},ae={key:0,class:"mt-2 text-sm text-red-600"},oe={class:"mt-1"},le=["disabled"],ne={key:0,class:"mt-2 text-sm text-red-600"},ie={key:1,class:"mt-2 text-sm text-gray-500"},re={class:"mt-1"},de={key:0,class:"mt-2 text-sm text-red-600"},me={class:"mt-1"},ue={key:0,class:"mt-2 text-sm text-red-600"},ce={class:"mt-1"},pe={key:0,class:"mt-2 text-sm text-red-600"},ve={class:"mt-1"},ye={key:0,class:"mt-2 text-sm text-red-600"},xe={class:"mt-1"},_e={key:0,class:"mt-2 text-sm text-red-600"},be={class:"flex items-center"},fe={class:"flex justify-end"},ge=["disabled"],we={key:0,class:"inline-flex items-center"},he={key:1},Se=D({__name:"CompanyFormView",setup(Ce){const _=M(),h=S(),u=R(),y=b(()=>{const o=h.params.id;return o?parseInt(o):null}),c=b(()=>!!y.value),t=q({name:"",legal_name:"",code:"",email:"",phone:"",website:"",address:"",currency:"USD",is_active:!0}),a=A({});async function C(){if(y.value){const o=await u.fetchCompany(y.value);o?Object.assign(t,{name:o.name,legal_name:o.legal_name,code:o.code,email:o.email||"",phone:o.phone||"",website:o.website||"",address:o.street||"",currency:o.currency,is_active:o.is_active}):_.push("/companies")}}function k(){return a.value={},t.name.trim()||(a.value.name="Company name is required"),t.legal_name.trim()||(a.value.legal_name="Legal name is required"),t.code.trim()?/^[A-Z0-9_-]+$/i.test(t.code)||(a.value.code="Company code can only contain letters, numbers, underscores, and hyphens"):a.value.code="Company code is required",t.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)&&(a.value.email="Please enter a valid email address"),t.currency||(a.value.currency="Currency is required"),t.website&&!t.website.startsWith("http")&&(t.website="https://"+t.website),Object.keys(a.value).length===0}async function U(){if(k())try{if(c.value&&y.value){const o={name:t.name,legal_name:t.legal_name,email:t.email||void 0,phone:t.phone||void 0,website:t.website||void 0,street:t.address||void 0,currency:t.currency,is_active:t.is_active};await u.updateCompany(y.value,o)}else{const o={name:t.name,legal_name:t.legal_name,code:t.code.toUpperCase(),email:t.email||void 0,phone:t.phone||void 0,website:t.website||void 0,street:t.address||void 0,currency:t.currency,is_active:t.is_active};await u.createCompany(o)}_.push("/companies")}catch(o){console.error("Failed to save company:",o)}}return E(()=>{u.clearError(),C()}),(o,s)=>{const V=P("router-link");return n(),B(L,null,{default:f(()=>[e("div",J,[e("div",O,[e("div",Y,[e("h1",$,i(c.value?"Edit Company":"Create Company"),1),e("p",G,i(c.value?"Update company information":"Add a new company to the system"),1)]),e("div",I,[g(V,{to:"/companies",class:"btn btn-secondary mr-3"},{default:f(()=>s[9]||(s[9]=[w(" Cancel ",-1)])),_:1,__:[9]})])]),e("div",T,[e("form",{onSubmit:N(U,["prevent"]),class:"card-body space-y-6"},[x(u).error?(n(),r("div",W,[e("div",H,[e("div",Z,[g(x(F),{class:"h-5 w-5 text-red-400"})]),e("div",K,[s[10]||(s[10]=e("h3",{class:"text-sm font-medium text-red-800"}," Error ",-1)),e("div",Q,i(x(u).error),1)])])])):d("",!0),e("div",X,[e("div",null,[s[11]||(s[11]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700"}," Company Name * ",-1)),e("div",ee,[m(e("input",{id:"name","onUpdate:modelValue":s[0]||(s[0]=l=>t.name=l),type:"text",required:"",class:p(["input",{"border-red-300":a.value.name}])},null,2),[[v,t.name]])]),a.value.name?(n(),r("p",te,i(a.value.name),1)):d("",!0)]),e("div",null,[s[12]||(s[12]=e("label",{for:"legal_name",class:"block text-sm font-medium text-gray-700"}," Legal Name * ",-1)),e("div",se,[m(e("input",{id:"legal_name","onUpdate:modelValue":s[1]||(s[1]=l=>t.legal_name=l),type:"text",required:"",class:p(["input",{"border-red-300":a.value.legal_name}])},null,2),[[v,t.legal_name]])]),a.value.legal_name?(n(),r("p",ae,i(a.value.legal_name),1)):d("",!0),s[13]||(s[13]=e("p",{class:"mt-1 text-sm text-gray-500"}," Official legal name of the company ",-1))]),e("div",null,[s[14]||(s[14]=e("label",{for:"code",class:"block text-sm font-medium text-gray-700"}," Company Code * ",-1)),e("div",oe,[m(e("input",{id:"code","onUpdate:modelValue":s[2]||(s[2]=l=>t.code=l),type:"text",required:"",disabled:c.value,class:p(["input",{"border-red-300":a.value.code,"bg-gray-50 cursor-not-allowed":c.value}])},null,10,le),[[v,t.code]])]),a.value.code?(n(),r("p",ne,i(a.value.code),1)):d("",!0),c.value?(n(),r("p",ie," Company code cannot be changed after creation ")):d("",!0)]),e("div",null,[s[15]||(s[15]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700"}," Email ",-1)),e("div",re,[m(e("input",{id:"email","onUpdate:modelValue":s[3]||(s[3]=l=>t.email=l),type:"email",class:p(["input",{"border-red-300":a.value.email}])},null,2),[[v,t.email]])]),a.value.email?(n(),r("p",de,i(a.value.email),1)):d("",!0)]),e("div",null,[s[16]||(s[16]=e("label",{for:"phone",class:"block text-sm font-medium text-gray-700"}," Phone ",-1)),e("div",me,[m(e("input",{id:"phone","onUpdate:modelValue":s[4]||(s[4]=l=>t.phone=l),type:"tel",class:p(["input",{"border-red-300":a.value.phone}])},null,2),[[v,t.phone]])]),a.value.phone?(n(),r("p",ue,i(a.value.phone),1)):d("",!0)]),e("div",null,[s[17]||(s[17]=e("label",{for:"website",class:"block text-sm font-medium text-gray-700"}," Website ",-1)),e("div",ce,[m(e("input",{id:"website","onUpdate:modelValue":s[5]||(s[5]=l=>t.website=l),type:"url",class:p(["input",{"border-red-300":a.value.website}])},null,2),[[v,t.website]])]),a.value.website?(n(),r("p",pe,i(a.value.website),1)):d("",!0)]),e("div",null,[s[19]||(s[19]=e("label",{for:"currency",class:"block text-sm font-medium text-gray-700"}," Currency * ",-1)),e("div",ve,[m(e("select",{id:"currency","onUpdate:modelValue":s[6]||(s[6]=l=>t.currency=l),required:"",class:p(["input",{"border-red-300":a.value.currency}])},s[18]||(s[18]=[e("option",{value:""},"Select currency",-1),e("option",{value:"USD"},"USD - US Dollar",-1),e("option",{value:"EUR"},"EUR - Euro",-1),e("option",{value:"GBP"},"GBP - British Pound",-1),e("option",{value:"JPY"},"JPY - Japanese Yen",-1),e("option",{value:"CAD"},"CAD - Canadian Dollar",-1),e("option",{value:"AUD"},"AUD - Australian Dollar",-1)]),2),[[j,t.currency]])]),a.value.currency?(n(),r("p",ye,i(a.value.currency),1)):d("",!0)])]),e("div",null,[s[20]||(s[20]=e("label",{for:"address",class:"block text-sm font-medium text-gray-700"}," Address ",-1)),e("div",xe,[m(e("textarea",{id:"address","onUpdate:modelValue":s[7]||(s[7]=l=>t.address=l),rows:"3",class:p(["input",{"border-red-300":a.value.address}])},null,2),[[v,t.address]])]),a.value.address?(n(),r("p",_e,i(a.value.address),1)):d("",!0)]),e("div",be,[m(e("input",{id:"is_active","onUpdate:modelValue":s[8]||(s[8]=l=>t.is_active=l),type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,512),[[z,t.is_active]]),s[21]||(s[21]=e("label",{for:"is_active",class:"ml-2 block text-sm text-gray-900"}," Company is active ",-1))]),e("div",fe,[e("button",{type:"submit",disabled:x(u).isLoading,class:"btn btn-primary"},[x(u).isLoading?(n(),r("span",we,[s[22]||(s[22]=e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),w(" "+i(c.value?"Updating...":"Creating..."),1)])):(n(),r("span",he,i(c.value?"Update Company":"Create Company"),1))],8,ge)])],32)])])]),_:1})}}});export{Se as default};
