import{A as i,B,r as f,p as P}from"./index-Cr4MYUY-.js";class C{async getPartners(t){return i.get("/v1/partners/",{params:t})}async getPartner(t){return i.get(`/v1/partners/${t}`)}async createPartner(t){return i.post("/v1/partners/",t)}async updatePartner(t,u){return i.put(`/v1/partners/${t}`,u)}async deletePartner(t){return i.delete(`/v1/partners/${t}`)}async activatePartner(t){return i.post(`/v1/partners/${t}/activate`)}async deactivatePartner(t){return i.post(`/v1/partners/${t}/deactivate`)}}const v=new C,L=B("partners",()=>{const l=f([]),t=f(null),u=f(!1),s=f(null),y=f({total:0,page:1,size:10,pages:0}),p=P(()=>{var e;return((e=l.value)==null?void 0:e.filter(r=>r.is_active))||[]}),h=P(()=>p.value.filter(e=>e.is_customer)),w=P(()=>p.value.filter(e=>e.is_supplier)),F=P(()=>p.value.filter(e=>e.is_vendor)),$=P(()=>p.value.map(e=>({value:e.id,label:`${e.name}${e.code?` (${e.code})`:""}`})));async function m(e){var r,n;try{u.value=!0,s.value=null;const a=await v.getPartners(e);l.value=a.partners,y.value={total:a.total,page:a.page,size:a.per_page,pages:a.pages}}catch(a){s.value=((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.detail)||"Failed to fetch partners",console.error("Failed to fetch partners:",a)}finally{u.value=!1}}async function x(e){var r,n;try{u.value=!0,s.value=null;const a=await v.getPartner(e);return t.value=a,a}catch(a){return s.value=((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.detail)||"Failed to fetch partner",console.error("Failed to fetch partner:",a),null}finally{u.value=!1}}async function S(e){var r,n;try{u.value=!0,s.value=null;const a=await v.createPartner(e);return l.value||(l.value=[]),l.value.unshift(a),y.value.total+=1,a}catch(a){throw s.value=((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.detail)||"Failed to create partner",console.error("Failed to create partner:",a),a}finally{u.value=!1}}async function _(e,r){var n,a,c;try{u.value=!0,s.value=null;const o=await v.updatePartner(e,r);if(l.value){const d=l.value.findIndex(g=>g.id===e);d!==-1&&(l.value[d]=o)}return((n=t.value)==null?void 0:n.id)===e&&(t.value=o),o}catch(o){throw s.value=((c=(a=o.response)==null?void 0:a.data)==null?void 0:c.detail)||"Failed to update partner",console.error("Failed to update partner:",o),o}finally{u.value=!1}}async function z(e){var r,n,a;try{u.value=!0,s.value=null,await v.deletePartner(e),l.value&&(l.value=l.value.filter(c=>c.id!==e),y.value.total-=1),((r=t.value)==null?void 0:r.id)===e&&(t.value=null)}catch(c){throw s.value=((a=(n=c.response)==null?void 0:n.data)==null?void 0:a.detail)||"Failed to delete partner",console.error("Failed to delete partner:",c),c}finally{u.value=!1}}async function I(e,r){var n,a,c;try{u.value=!0,s.value=null;const o=r?await v.activatePartner(e):await v.deactivatePartner(e);if(l.value){const d=l.value.findIndex(g=>g.id===e);d!==-1&&(l.value[d]=o)}((n=t.value)==null?void 0:n.id)===e&&(t.value=o)}catch(o){throw s.value=((c=(a=o.response)==null?void 0:a.data)==null?void 0:c.detail)||`Failed to ${r?"activate":"deactivate"} partner`,console.error("Failed to toggle partner status:",o),o}finally{u.value=!1}}function b(){s.value=null}function A(){t.value=null}return{partners:l,currentPartner:t,isLoading:u,error:s,pagination:y,activePartners:p,customers:h,suppliers:w,vendors:F,partnerOptions:$,fetchPartners:m,fetchPartner:x,createPartner:S,updatePartner:_,deletePartner:z,togglePartnerStatus:I,clearError:b,clearCurrentPartner:A}});export{L as u};
