import{A as i,B as _,r as y,p as C}from"./index-Cr4MYUY-.js";class b{async getCompanies(t){return i.get("/v1/companies/",{params:t})}async getCompany(t){return i.get(`/v1/companies/${t}`)}async createCompany(t){return i.post("/v1/companies/",t)}async updateCompany(t,c){return i.put(`/v1/companies/${t}`,c)}async deleteCompany(t){return i.delete(`/v1/companies/${t}`)}async activateCompany(t){return i.post(`/v1/companies/${t}/activate`)}async deactivateCompany(t){return i.post(`/v1/companies/${t}/deactivate`)}}const p=new b,B=_("companies",()=>{const l=y([]),t=y(null),c=y(!1),r=y(null),m=y({total:0,page:1,size:10,pages:0}),f=C(()=>l.value.filter(a=>a.is_active)),g=C(()=>f.value.map(a=>({value:a.id,label:`${a.name} (${a.code})`})));async function h(a){var o,n;try{c.value=!0,r.value=null;const e=await p.getCompanies(a);l.value=e.companies,m.value={total:e.total,page:e.page,size:e.per_page,pages:e.pages}}catch(e){r.value=((n=(o=e.response)==null?void 0:o.data)==null?void 0:n.detail)||"Failed to fetch companies",console.error("Failed to fetch companies:",e)}finally{c.value=!1}}async function w(a){var o,n;try{c.value=!0,r.value=null;const e=await p.getCompany(a);return t.value=e,e}catch(e){return r.value=((n=(o=e.response)==null?void 0:o.data)==null?void 0:n.detail)||"Failed to fetch company",console.error("Failed to fetch company:",e),null}finally{c.value=!1}}async function F(a){var o,n;try{c.value=!0,r.value=null;const e=await p.createCompany(a);return l.value||(l.value=[]),l.value.unshift(e),m.value.total+=1,e}catch(e){throw r.value=((n=(o=e.response)==null?void 0:o.data)==null?void 0:n.detail)||"Failed to create company",console.error("Failed to create company:",e),e}finally{c.value=!1}}async function $(a,o){var n,e,s;try{c.value=!0,r.value=null;const u=await p.updateCompany(a,o);if(l.value){const v=l.value.findIndex(d=>d.id===a);v!==-1&&(l.value[v]=u)}return((n=t.value)==null?void 0:n.id)===a&&(t.value=u),u}catch(u){throw r.value=((s=(e=u.response)==null?void 0:e.data)==null?void 0:s.detail)||"Failed to update company",console.error("Failed to update company:",u),u}finally{c.value=!1}}async function x(a){var o,n,e;try{c.value=!0,r.value=null,await p.deleteCompany(a),l.value&&(l.value=l.value.filter(s=>s.id!==a),m.value.total-=1),((o=t.value)==null?void 0:o.id)===a&&(t.value=null)}catch(s){throw r.value=((e=(n=s.response)==null?void 0:n.data)==null?void 0:e.detail)||"Failed to delete company",console.error("Failed to delete company:",s),s}finally{c.value=!1}}async function S(a,o){var n,e,s;try{c.value=!0,r.value=null;const u=o?await p.activateCompany(a):await p.deactivateCompany(a);if(l.value){const v=l.value.findIndex(d=>d.id===a);v!==-1&&(l.value[v]=u)}((n=t.value)==null?void 0:n.id)===a&&(t.value=u)}catch(u){throw r.value=((s=(e=u.response)==null?void 0:e.data)==null?void 0:s.detail)||`Failed to ${o?"activate":"deactivate"} company`,console.error("Failed to toggle company status:",u),u}finally{c.value=!1}}function z(){r.value=null}function I(){t.value=null}return{companies:l,currentCompany:t,isLoading:c,error:r,pagination:m,activeCompanies:f,companyOptions:g,fetchCompanies:h,fetchCompany:w,createCompany:F,updateCompany:$,deleteCompany:x,toggleCompanyStatus:S,clearError:z,clearCurrentCompany:I}});export{B as u};
